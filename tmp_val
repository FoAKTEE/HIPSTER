==17671== Memcheck, a memory error detector
==17671== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==17671== Using Valgrind-3.14.0 and LibVEX; rerun with -h for copyright info
==17671== Command: ./power -def
==17671== 
Survey correction function  specified, but in PERIODIC mode. Survey correction function will be ignored.
Reading radial binning file 'k_bin_small.csv'

# Found 10 radial bins in the file
Read in 10 radial k-space bins in range (0, 3) successfully.
Box Size = {1.20000e+03,1.20000e+03,1.20000e+03}
Grid = 100
Radial Bins = 10
Radial k-space binning = {0.10000, 3.10000} over 10 bins (user-defined bin widths) 
Output directory: ''
# Found 406933 particles from /tigress/ophilcox/hipster_data/quijote_halos_10.txt
# Rescaling input positions by factor 1.000000
# Done reading the particles
# Range of x positions are   0.00 to 1000.00
# Range of y positions are   0.01 to 1000.00
# Range of z positions are   0.00 to 1000.00
# Setting periodic box-size to 1000.00
# Allocating 20.180 MB of particles
# Allocating 15.259 MB of cells

There are 239204 filled cells compared with 1000000 total cells.

 RANDOM CATALOG 1 DIAGNOSTICS:
Grid cell-size = 10.00Mpc/h
Average number of particles per grid cell =   1.70
# Done gridding the particles
# 406933 particles in use, 406933 with positive weight
# Weights: Positive particles sum to 406933.000000
#          Negative particles sum to 0.000000
# Found 406933 particles from /tigress/ophilcox/hipster_data/quijote_halos_10.txt
# Rescaling input positions by factor 1.000000
# Done reading the particles
# Range of x positions are   0.00 to 1000.00
# Range of y positions are   0.01 to 1000.00
# Range of z positions are   0.00 to 1000.00
# Setting periodic box-size to 1000.00
# Allocating 20.180 MB of particles
# Allocating 15.259 MB of cells

There are 239204 filled cells compared with 1000000 total cells.

 RANDOM CATALOG 2 DIAGNOSTICS:
Grid cell-size = 10.00Mpc/h
Average number of particles per grid cell =   1.70
# Done gridding the particles
# 406933 particles in use, 406933 with positive weight
# Weights: Positive particles sum to 406933.000000
#          Negative particles sum to 0.000000
# Found 406933 particles from /tigress/ophilcox/hipster_data/quijote_halos_10.txt
# Rescaling input positions by factor 1.000000
# Done reading the particles
# Range of x positions are   0.00 to 1000.00
# Range of y positions are   0.01 to 1000.00
# Range of z positions are   0.00 to 1000.00
# Setting periodic box-size to 1000.00
# Allocating 20.180 MB of particles
# Allocating 15.259 MB of cells

There are 239204 filled cells compared with 1000000 total cells.

 RANDOM CATALOG 3 DIAGNOSTICS:
Grid cell-size = 10.00Mpc/h
Average number of particles per grid cell =   1.70
# Done gridding the particles
# 406933 particles in use, 406933 with positive weight
# Weights: Positive particles sum to 406933.000000
#          Negative particles sum to 0.000000
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x405833: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AA8F: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x405877: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AA8F: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Use of uninitialised value of size 8
==17671==    at 0x4058D4: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AA8F: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x4058E0: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AA8F: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x405917: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AA8F: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x40592A: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AA8F: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
Init time: 0 s
Creating kernel interpolator function
# 1st grid filled cells: 239204
# All 1st grid points in use: 406933
# Max points in one cell in grid 115
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x405833: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AB6B: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x405877: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AB6B: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Use of uninitialised value of size 8
==17671==    at 0x4058D4: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AB6B: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x4058E0: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AB6B: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x405917: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AB6B: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Conditional jump or move depends on uninitialised value(s)
==17671==    at 0x40592A: BispectrumCounts::BispectrumCounts(Parameters*, SurveyCorrection*, KernelInterp*) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AB6B: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== Invalid read of size 16
==17671==    at 0x409D76: BispectrumCounts::fill_up_counts(ThreeVector<double>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AFDB: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671==  Address 0x7a66a30 is 2,608 bytes inside a block of size 5,216 in arena "client"
==17671== 
==17671== Invalid write of size 8
==17671==    at 0x409D84: BispectrumCounts::fill_up_counts(ThreeVector<double>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x40AFDB: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671==  Address 0x7a66a30 is 2,608 bytes inside a block of size 5,216 in arena "client"
==17671== 
==17671== 
==17671== More than 10000000 total errors detected.  I'm not reporting any more.
==17671== Final error counts will be inaccurate.  Go fix your program!
==17671== Rerun with --error-limit=no to disable this cutoff.  Note
==17671== that errors may occur in your program without prior warning from
==17671== Valgrind, because errors are no longer being displayed.
==17671== 
# Starting power-spectrum particle-count computation single threaded.
Counting cell 1 of 239204 on thread 0: 0 percent complete
Counting cell 11962 of 239204 on thread 0: 5 percent complete
Counting cell 23922 of 239204 on thread 0: 10 percent complete
Counting cell 35882 of 239204 on thread 0: 15 percent complete
Counting cell 47842 of 239204 on thread 0: 20 percent complete
Counting cell 59802 of 239204 on thread 0: 25 percent complete
Counting cell 71763 of 239204 on thread 0: 30 percent complete
Counting cell 83723 of 239204 on thread 0: 35 percent complete
Counting cell 95683 of 239204 on thread 0: 40 percent complete
Counting cell 107643 of 239204 on thread 0: 45 percent complete
Counting cell 119603 of 239204 on thread 0: 50 percent complete
Counting cell 131564 of 239204 on thread 0: 55 percent complete
Counting cell 143524 of 239204 on thread 0: 60 percent complete
Counting cell 155484 of 239204 on thread 0: 65 percent complete
Counting cell 167444 of 239204 on thread 0: 70 percent complete
Counting cell 179404 of 239204 on thread 0: 75 percent complete
Counting cell 191365 of 239204 on thread 0: 80 percent complete
Counting cell 203325 of 239204 on thread 0: 85 percent complete
Counting cell 215285 of 239204 on thread 0: 90 percent complete
Counting cell 227245 of 239204 on thread 0: 95 percent complete

Computing analytic RRR term==17671== 
==17671== Process terminating with default action of signal 11 (SIGSEGV)
==17671==  Access not within mapped region at address 0xC0
==17671==    at 0x5F2B61D: vfprintf (in /usr/lib64/libc-2.17.so)
==17671==    by 0x5F363F6: fprintf (in /usr/lib64/libc-2.17.so)
==17671==    by 0x40B52C: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671==  If you believe this happened as a result of a stack
==17671==  overflow in your program's main thread (unlikely but
==17671==  possible), you can try to increase the size of the
==17671==  main thread stack using the --main-stacksize= flag.
==17671==  The main thread stack size used in this run was 16777216.
==17671== 
==17671== HEAP SUMMARY:
==17671==     in use at exit: 301,601,513 bytes in 377 blocks
==17671==   total heap usage: 543 allocs, 166 frees, 597,086,653 bytes allocated
==17671== 
==17671== 60 bytes in 1 blocks are definitely lost in loss record 110 of 369
==17671==    at 0x4C2C2A5: memalign (vg_replace_malloc.c:908)
==17671==    by 0x4C2C36F: posix_memalign (vg_replace_malloc.c:1072)
==17671==    by 0x40ABA0: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== 29,160 bytes in 1 blocks are definitely lost in loss record 131 of 369
==17671==    at 0x4C2C2A5: memalign (vg_replace_malloc.c:908)
==17671==    by 0x4C2C36F: posix_memalign (vg_replace_malloc.c:1072)
==17671==    by 0x40ABC4: group_counter::group_counter(Grid*, Grid*, Grid*, Parameters*, SurveyCorrection*, KernelInterp*, ThreeVector<int>*, int) (in /home/ophilcox/hipster/power)
==17671==    by 0x4026D9: main (in /home/ophilcox/hipster/power)
==17671== 
==17671== LEAK SUMMARY:
==17671==    definitely lost: 29,220 bytes in 2 blocks
==17671==    indirectly lost: 0 bytes in 0 blocks
==17671==      possibly lost: 0 bytes in 0 blocks
==17671==    still reachable: 301,572,293 bytes in 375 blocks
==17671==         suppressed: 0 bytes in 0 blocks
==17671== Reachable blocks (those to which a pointer was found) are not shown.
==17671== To see them, rerun with: --leak-check=full --show-leak-kinds=all
==17671== 
==17671== For counts of detected and suppressed errors, rerun with: -v
==17671== Use --track-origins=yes to see where uninitialised values come from
==17671== ERROR SUMMARY: 10000002 errors from 16 contexts (suppressed: 0 from 0)
